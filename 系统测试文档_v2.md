# 文档信息（System Test Spec v2）

| 项目 | 内容 |
| --- | --- |
| 项目名称 | Yigofang_Mall（易购坊 Mall） |
| 项目类型 | 《移动互联网编程实践》课程大作业（商城-商品浏览） |
| 技术框架 | HarmonyOS NEXT / ArkTS / ArkUI |
| 被测版本 | App：v2（以本仓库当前代码为准） |
| 测试日期 | 2026年01月04日 |
| 文档版本 | 2.0 |
| 编写/维护 | 测试组 |

## 修订记录

| 版本 | 日期 | 修订人 | 说明 |
| --- | --- | --- | --- |
| 1.0 | 2025年12月 | - | 旧版系统测试文档 |
| 2.0 | 2026年01月04日 | - | 基于现有架构补齐测试策略/范围边界/用例矩阵/准入准出/缺陷流程与可追溯性 |

---

## 1. 概述

### 1.1 项目简介

Yigofang_Mall 是基于 HarmonyOS NEXT 的 ArkUI 声明式 UI 应用，当前实现“商品浏览系统”的核心交互：

- 单页入口：`pages/ListIndex`
- 顶部 Tabs 分类切换：精选/手机/服饰/穿搭/家居
- 商品列表：LazyForEach + IDataSource 懒加载渲染
- 下拉刷新：手势触发 UI 状态变化 + 定时器模拟刷新
- 触底加载更多：触摸上滑阈值触发数据源追加 + 定时器模拟网络延迟
- 数据来源：本地模拟数据（InitialData），无真实网络/无持久化数据库

### 1.2 参考资料

- 架构设计：仓库根目录《架构设计.md》
- 需求分析：仓库根目录《需求分析文档.md》
- 旧版测试：仓库根目录《系统测试文档.md》


---

## 2. 被测系统与架构要点

### 2.1 模块划分（按现有工程）

- 入口与生命周期：EntryAbility
- 页面：ListIndex
- 组件：TabBarsComponent、GoodsListComponent、PutDownRefreshLayout（刷新指示器）
- 数据层：InitialData、ListDataSource（IDataSource）
- 公共层：CommonConstants

### 2.2 关键业务流程（用于测试设计）

1. 启动应用 → EntryAbility 加载 pages/ListIndex
2. ListIndex 渲染 Navigation + TabBar
3. TabBar 切换分类并在每个 Tab 下挂载 GoodsList(categoryId)
4. GoodsList 通过 ListDataSource(categoryId) 懒加载渲染
5. 下拉刷新：TabBar 维护 refreshStatus/pullDownOffset/refreshText，定时复位
6. 触底加载：GoodsList 上滑阈值触发 pushData()，定时追加并通知 UI

---

## 3. 测试目标

- 验证核心功能：分类切换、商品列表展示、下拉刷新、加载更多、数据隔离
- 验证关键交互：触摸阈值、回弹、刷新/加载提示、连续操作的稳定性
- 验证非功能：性能（帧率/响应时间/内存）、兼容适配（分辨率/字体缩放）、可靠性（无崩溃）
- 建立需求-用例可追溯关系，支持验收与回归

---

## 4. 测试范围

- FR-001/002/003：商品列表与信息展示
- FR-006/007/008/009：顶部 Tab 导航、切换样式、分类数据隔离
- FR-010：LazyForEach 懒加载行为
- FR-011：下拉刷新
- FR-012：加载更多
- FR-014/015/017：列表滚动、到底提示、触摸事件处理

---

## 5. 测试策略与方法

### 5.1 测试类型

- 系统功能测试（手工为主）
- UI/交互测试（布局、样式、触摸手势）
- 稳定性与异常测试（高频操作、边界输入、后台切前台）

### 5.2 测试方法与原则

- 以“关键路径优先”设计用例：启动 → 浏览 → 切换分类 → 刷新/加载
- 覆盖“边界 + 异常 + 并发操作”：刷新时切换 Tab、加载中重复触发
- 针对模拟行为：以“状态正确、提示正确、无重复数据、无崩溃”为判定标准

### 5.3 进入/退出准则

- 准入（Entry Criteria）
  - 代码可编译、可安装运行
  - 资源文件齐全（图片/字符串）
  - 主要页面可正常打开

- 准出（Exit Criteria）
  - P0 缺陷清零；P1 缺陷关闭或有明确规避方案
  - 核心功能用例通过率 ≥ 95%
  - 性能指标满足或给出偏差原因与优化建议

---

## 6. 测试环境

### 6.1 软硬件环境（建议填写实际测试数据）

- 开发工具：DevEco Studio 6.0
- SDK：HarmonyOS NEXT 对应 SDK
- 设备：模拟器

### 6.2 测试数据

- 初始数据：InitialData 内置各分类 4~5 条数据
- 追加数据：ListDataSource.pushData() 生成更多数据
- 刷新数据：ListDataSource.refreshData() 重新生成并随机打乱（shuffleArray）

---

## 7. 缺陷管理

### 7.1 缺陷等级（建议）

| 等级 | 定义 | 示例 |
| --- | --- | --- |
| P0 | 阻塞/崩溃/无法进入主流程 | 应用启动崩溃、页面白屏 |
| P1 | 核心功能不可用或结果错误 | 刷新无法复位、分类数据混乱 |
| P2 | 一般功能/交互问题 | 提示文案错误、偶发重复加载 |
| P3 | 体验/样式问题 | 对齐偏差、边距不一致 |

### 7.2 缺陷字段

- 标题、版本、环境、复现步骤、实际结果、期望结果、截图/录屏

---

## 8. 测试用例设计（v2）
### 8.1 启动与页面加载

| 用例ID | 用例名称 | 前置条件 | 步骤 | 期望结果 | 关联需求 |
| --- | --- | --- | --- | --- | --- |
| ST-BOOT-001 | 冷启动进入主页面 | 已安装应用 | 1) 冷启动应用 2) 等待页面稳定 | 成功进入 ListIndex，出现标题与 Tabs，列表有数据 | NFR-001 |
| ST-BOOT-002 | 后台切前台稳定性 | 应用已启动 | 1) 切后台 2) 再切回前台 | UI 不重置为异常状态；无崩溃、无明显卡死 | NFR-014 |

### 8.2 Tabs 分类切换（TabBarsComponent）

| 用例ID | 用例名称 | 前置条件 | 步骤 | 期望结果 | 关联需求 |
| --- | --- | --- | --- | --- | --- |
| ST-TAB-001 | 五个分类可见且可切换 | 主页面加载完成 | 依次点击：精选/手机/服饰/穿搭/家居 | 每次切换后列表内容变化；无闪退 | FR-006/007 |
| ST-TAB-002 | 选中态样式变化 | 主页面加载完成 | 点击不同 Tab 观察样式 | 选中 Tab 高亮（字体/颜色与未选中有差异） | FR-008 |
| ST-TAB-003 | 快速连续切换稳定性 | 主页面加载完成 | 快速点击不同 Tab 10 次以上 | 不崩溃；列表仍可滚动；无明显错位 | NFR-014 |
| ST-TAB-004 | 分类数据隔离 | 已在分类A加载更多 | 1) 在分类A触发加载更多 2) 切换到分类B观察 3) 再返回分类A | 分类B不受A影响；返回A数据状态合理（不混入其他分类） | FR-009 |

### 8.3 商品列表展示（GoodsListComponent + LazyForEach）

| 用例ID | 用例名称 | 前置条件 | 步骤 | 期望结果 | 关联需求 |
| --- | --- | --- | --- | --- | --- |
| ST-LIST-001 | 商品卡片信息完整 | 主页面加载完成 | 检查任意 3 个商品项字段 | 名称/价格/图片/广告语/评价均可见且无明显错位 | FR-001/002/003 |
| ST-LIST-002 | 列表可滚动且无明显卡顿 | 主页面加载完成 | 上下滚动 30 秒 | 滚动顺滑；无明显掉帧卡死（目标 ≥ 40fps） | FR-014/NFR-002 |
| ST-LIST-003 | 懒加载按需取数 | 主页面加载完成 | 快速滑动到列表下部并返回顶部 | 不出现大面积白块；内容逐步渲染；无重复渲染异常 | FR-010 |

### 8.4 下拉刷新（TabBarsComponent + PutDownRefreshLayout + ListDataSource.refreshData）

| 用例ID | 用例名称 | 前置条件 | 步骤 | 期望结果 | 关联需求 |
| --- | --- | --- | --- | --- | --- |
| ST-REF-001 | 达到阈值触发刷新 | 列表在顶部附近 | 1) 下拉超过阈值 2) 松手 | 进入刷新状态；提示文案/指示器显示；到时自动复位 | FR-011/FR-017 |
| ST-REF-002 | 未到阈值不触发刷新 | 列表在顶部附近 | 1) 轻微下拉未达阈值 2) 松手 | 不进入刷新状态；界面回弹复位 | FR-011 |
| ST-REF-003 | 刷新后数据发生变化（顺序） | 已记录刷新前前 5 个商品 id/名称 | 触发一次刷新并等待结束 | 刷新后列表顺序变化（允许少量位置不变，但整体有变化） | FR-011 |
| ST-REF-004 | 刷新过程中切换 Tab 的一致性 | 正在刷新 | 1) 触发刷新 2) 刷新未结束时切换 Tab 3) 再切回 | 不崩溃；刷新状态最终可复位；不出现“卡在刷新态” | NFR-014 |

### 8.5 加载更多（GoodsListComponent + ListDataSource.pushData）

| 用例ID | 用例名称 | 前置条件 | 步骤 | 期望结果 | 关联需求 |
| --- | --- | --- | --- | --- | --- |
| ST-MORE-001 | 上滑触发加载更多 | 列表可滚动 | 1) 在列表区域上滑超过阈值 2) 等待加载结束 | 出现“正在加载更多...”反馈；随后列表数据增加或状态更新 | FR-012/FR-017 |
| ST-MORE-002 | 加载中防重复触发 | 列表可滚动 | 1) 触发加载更多 2) 0.5s 内继续上滑多次 | 只触发一次加载；不出现明显重复追加/异常提示 | FR-012/NFR-013 |
| ST-MORE-003 | 达到最大长度停止加载 | 可多次触发加载 | 连续触发直到达到 MAX_DATA_LENGTH 再触发 | 达到上限后不再新增数据；提示文案合理；无异常 | NFR-013 |

### 8.6 数据正确性（InitialData / ID 递增 / DataSource 边界）

| 用例ID | 用例名称 | 前置条件 | 步骤 | 期望结果 | 关联需求 |
| --- | --- | --- | --- | --- | --- |
| ST-DATA-001 | 商品ID唯一性（观察性验证） | 可查看商品标识（若UI不展示则通过日志/断点） | 多次刷新与加载更多后检查 id 是否重复 | 不出现明显重复 id；数据源行为稳定 | NFR-013 |
| ST-DATA-002 | getData 越界兜底 | 通过极限滑动触发取数边界 | 快速滚动/跳转导致索引逼近末尾 | 不崩溃；兜底逻辑返回最后一条不引发异常 | NFR-014 |

---

## 9. 非功能测试（执行说明）

### 9.1 性能

- 启动耗时：冷启动到首屏可操作（目标 < 2s，NFR-001）
- 帧率：列表快速滚动时保持 ≥ 40fps（NFR-002/FR-013）
- 内存：多次切换 Tab/刷新/加载后内存不持续爬升（目标 < 100MB，NFR-003）

记录建议：
- 使用 DevEco 性能工具或系统性能面板记录启动、内存、帧率曲线；截屏存档。

### 9.2 兼容与适配

- 不同分辨率/屏幕尺寸：布局不遮挡、不溢出
- 字体缩放：关键文本不重叠、不截断到不可读
- 横竖屏：若项目未声明支持旋转，则仅验证“旋转不会崩溃/界面不严重错乱”（按现状验收）

### 9.3 稳定性

- Monkey/高频操作（手工模拟）：连续滚动 + 切 Tab + 刷新/加载交替 5 分钟
- 判定：无崩溃、无明显卡死、刷新/加载状态可回到稳定态

---

## 10. 需求-用例可追溯矩阵（摘要）

| 需求ID | 需求描述 | 覆盖用例 |
| --- | --- | --- |
| FR-001 | 商品列表显示 | ST-LIST-001 |
| FR-002 | 图片显示 | ST-LIST-001 |
| FR-003 | 商品信息展示 | ST-LIST-001 |
| FR-006 | 顶部Tab导航 | ST-TAB-001 |
| FR-007 | Tab切换 | ST-TAB-001 |
| FR-008 | Tab样式切换 | ST-TAB-002 |
| FR-009 | 分类数据隔离 | ST-TAB-004 |
| FR-010 | 懒加载 | ST-LIST-003 |
| FR-011 | 下拉刷新 | ST-REF-001/002/003/004 |
| FR-012 | 加载更多 | ST-MORE-001/002/003 |
| FR-014 | 列表滚动 | ST-LIST-002 |
| FR-015 | 到底提示 | ST-MORE-003（结合提示验证） |
| FR-017 | 触摸事件处理 | ST-REF-001、ST-MORE-001 |
| NFR-001 | 页面加载时间 | ST-BOOT-001（配合计时） |
| NFR-002 | 滚动帧率 ≥ 40fps | ST-LIST-002（配合性能工具） |
| NFR-003 | 内存占用 < 100MB | 性能章节执行记录 |
| NFR-014 | 应用稳定无崩溃 | ST-BOOT-002、稳定性章节 |

---

## 11. 测试交付物清单

- 系统测试文档 v2（本文档）
- 测试执行记录（截图/录屏/性能曲线）
- 缺陷列表与修复回归记录
- 版本验收结论（通过/有条件通过/不通过）
